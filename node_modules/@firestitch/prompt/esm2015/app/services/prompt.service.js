import { FsPromptDateComponent } from './../components/prompt-date/prompt-date.component';
import { Injectable, } from '@angular/core';
// Modal
import { MatDialog } from '@angular/material/dialog';
// RX
import { throwError, of } from 'rxjs';
import { switchMap } from 'rxjs/operators';
// Configs
import { FsPromptConfig, FsPromptConfirmConfig } from '../classes';
// Components for open in modal
import { FsPromptConfirmComponent } from '../components/prompt-confirm/prompt-confirm.component';
import { FsPromptAutocompleteComponent } from '../components/prompt-autocomplete/prompt-autocomplete.component';
import { FsPromptSelectComponent } from '../components/prompt-select/prompt-select.component';
import { FsPromptInputComponent } from '../components/prompt-input/prompt-input.component';
import { PromptType } from '../helpers/enums';
import { FsPromptAutocompleteChipsComponent } from '../components/prompt-autocomplete-chips/prompt-autocomplete-chips.component';
import * as i0 from "@angular/core";
import * as i1 from "@angular/material/dialog";
export class FsPrompt {
    constructor(dialog) {
        this.dialog = dialog;
    }
    /**
     * Open confirmation window and return close observable
     */
    confirm(config = {}) {
        const openConfig = new FsPromptConfirmConfig(config, PromptType.confirm);
        return this.open(openConfig);
    }
    /**
     * Open window with input field for filling
     */
    input(config = {}) {
        const openConfig = new FsPromptConfig(config, PromptType.input);
        return this.open(openConfig);
    }
    /**
     * Open modal with list
     */
    select(config = {}) {
        const openConfig = new FsPromptConfig(config, PromptType.select);
        return this.open(openConfig);
    }
    /**
     * Open modal with autocomplete
     */
    autocomplete(config = {}) {
        const openConfig = new FsPromptConfig(config, PromptType.autocomplete);
        return this.open(openConfig);
    }
    /**
     * Open modal with autocomplete chips
     */
    autocompleteChips(config = {}) {
        const openConfig = new FsPromptConfig(config, PromptType.autocompleteChips);
        return this.open(openConfig);
    }
    /**
     * Open modal with list
     */
    dateTime(config = {}) {
        config.autofocus = false;
        const openConfig = new FsPromptConfig(config, PromptType.dateTime);
        return this.open(openConfig);
    }
    /**
     * Open modal with list
     */
    date(config = {}) {
        config.autofocus = false;
        const openConfig = new FsPromptConfig(config, PromptType.date);
        return this.open(openConfig);
    }
    /**
     * Open modal dialog depends from type
     */
    open(config) {
        // Default classes for modal
        config.addDefaultPanelClasses(config.type);
        switch (config.type) {
            case PromptType.confirm: {
                return this.dialog
                    .open(FsPromptConfirmComponent, config.dialogConfig)
                    .afterClosed()
                    .pipe(switchMap((value) => value === undefined ? throwError('error') : of(value)));
            }
            case PromptType.input: {
                return this.dialog.open(FsPromptInputComponent, config.dialogConfig)
                    .afterClosed()
                    .pipe(switchMap((value) => value === undefined ? throwError('error') : of(value)));
            }
            case PromptType.select: {
                return this.dialog.open(FsPromptSelectComponent, config.dialogConfig)
                    .afterClosed()
                    .pipe(switchMap((value) => value === undefined ? throwError('error') : of(value)));
            }
            case PromptType.autocomplete: {
                return this.dialog.open(FsPromptAutocompleteComponent, config.dialogConfig)
                    .afterClosed()
                    .pipe(switchMap((value) => value === undefined ? throwError('error') : of(value)));
            }
            case PromptType.autocompleteChips: {
                return this.dialog.open(FsPromptAutocompleteChipsComponent, config.dialogConfig)
                    .afterClosed()
                    .pipe(switchMap((value) => value === undefined ? throwError('error') : of(value)));
            }
            case PromptType.date:
            case PromptType.dateTime: {
                return this.dialog.open(FsPromptDateComponent, config.dialogConfig)
                    .afterClosed()
                    .pipe(switchMap((value) => value === undefined ? throwError('error') : of(value)));
            }
            default: return throwError('Erorr');
        }
    }
}
FsPrompt.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: FsPrompt, deps: [{ token: i1.MatDialog }], target: i0.ɵɵFactoryTarget.Injectable });
FsPrompt.ɵprov = i0.ɵɵngDeclareInjectable({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: FsPrompt, providedIn: 'root' });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "12.2.16", ngImport: i0, type: FsPrompt, decorators: [{
            type: Injectable,
            args: [{
                    providedIn: 'root',
                }]
        }], ctorParameters: function () { return [{ type: i1.MatDialog }]; } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicHJvbXB0LnNlcnZpY2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvYXBwL3NlcnZpY2VzL3Byb21wdC5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLG1EQUFtRCxDQUFDO0FBQzFGLE9BQU8sRUFDTCxVQUFVLEdBQ1gsTUFBTSxlQUFlLENBQUM7QUFFdkIsUUFBUTtBQUNSLE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUVyRCxLQUFLO0FBQ0wsT0FBTyxFQUFFLFVBQVUsRUFBRSxFQUFFLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDdEMsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBSzNDLFVBQVU7QUFDVixPQUFPLEVBQUUsY0FBYyxFQUFFLHFCQUFxQixFQUFFLE1BQU0sWUFBWSxDQUFDO0FBRW5FLCtCQUErQjtBQUMvQixPQUFPLEVBQUUsd0JBQXdCLEVBQUUsTUFBTSx1REFBdUQsQ0FBQztBQUNqRyxPQUFPLEVBQUUsNkJBQTZCLEVBQUUsTUFBTSxpRUFBaUUsQ0FBQztBQUNoSCxPQUFPLEVBQUUsdUJBQXVCLEVBQUUsTUFBTSxxREFBcUQsQ0FBQztBQUM5RixPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxtREFBbUQsQ0FBQztBQUMzRixPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDOUMsT0FBTyxFQUFFLGtDQUFrQyxFQUFFLE1BQU0sNkVBQTZFLENBQUM7OztBQU9qSSxNQUFNLE9BQU8sUUFBUTtJQUVuQixZQUFvQixNQUFpQjtRQUFqQixXQUFNLEdBQU4sTUFBTSxDQUFXO0lBQUcsQ0FBQztJQUV6Qzs7T0FFRztJQUNJLE9BQU8sQ0FBQyxTQUEwQixFQUFFO1FBQ3pDLE1BQU0sVUFBVSxHQUFHLElBQUkscUJBQXFCLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUV6RSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUVEOztPQUVHO0lBQ0ksS0FBSyxDQUFDLFNBQTBCLEVBQUU7UUFDdkMsTUFBTSxVQUFVLEdBQUcsSUFBSSxjQUFjLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUVoRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUVEOztPQUVHO0lBQ0ksTUFBTSxDQUFDLFNBQTBCLEVBQUU7UUFDeEMsTUFBTSxVQUFVLEdBQUcsSUFBSSxjQUFjLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQyxNQUFNLENBQUMsQ0FBQztRQUVqRSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUVEOztPQUVHO0lBQ0ksWUFBWSxDQUFDLFNBQTBCLEVBQUU7UUFDOUMsTUFBTSxVQUFVLEdBQUcsSUFBSSxjQUFjLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUV2RSxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7SUFDL0IsQ0FBQztJQUVEOztPQUVHO0lBQ0ksaUJBQWlCLENBQUMsU0FBMkMsRUFBRTtRQUNwRSxNQUFNLFVBQVUsR0FBRyxJQUFJLGNBQWMsQ0FBQyxNQUFNLEVBQUUsVUFBVSxDQUFDLGlCQUFpQixDQUFDLENBQUM7UUFFNUUsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQy9CLENBQUM7SUFFRDs7T0FFRztJQUNJLFFBQVEsQ0FBQyxTQUEwQixFQUFFO1FBQzFDLE1BQU0sQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLE1BQU0sVUFBVSxHQUFHLElBQUksY0FBYyxDQUFDLE1BQU0sRUFBRSxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7UUFFbkUsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQy9CLENBQUM7SUFFRDs7T0FFRztJQUNJLElBQUksQ0FBQyxTQUEwQixFQUFFO1FBQ3RDLE1BQU0sQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO1FBQ3pCLE1BQU0sVUFBVSxHQUFHLElBQUksY0FBYyxDQUFDLE1BQU0sRUFBRSxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7UUFFL0QsT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQy9CLENBQUM7SUFFRDs7T0FFRztJQUNLLElBQUksQ0FBQyxNQUF3RDtRQUNuRSw0QkFBNEI7UUFDNUIsTUFBTSxDQUFDLHNCQUFzQixDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUUzQyxRQUFRLE1BQU0sQ0FBQyxJQUFJLEVBQUU7WUFDbkIsS0FBSyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQ3ZCLE9BQU8sSUFBSSxDQUFDLE1BQU07cUJBQ2YsSUFBSSxDQUFDLHdCQUF3QixFQUFFLE1BQU0sQ0FBQyxZQUFZLENBQUM7cUJBQ25ELFdBQVcsRUFBRTtxQkFDYixJQUFJLENBQ0gsU0FBUyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxLQUFLLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUM1RSxDQUFDO2FBQ0w7WUFFRCxLQUFLLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQztnQkFDckIsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxzQkFBc0IsRUFBRSxNQUFNLENBQUMsWUFBWSxDQUFDO3FCQUNuRSxXQUFXLEVBQUU7cUJBQ2IsSUFBSSxDQUNILFNBQVMsQ0FBQyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUMsS0FBSyxLQUFLLFNBQVMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FDNUUsQ0FBQzthQUNIO1lBRUQsS0FBSyxVQUFVLENBQUMsTUFBTSxDQUFDLENBQUM7Z0JBQ3RCLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsdUJBQXVCLEVBQUUsTUFBTSxDQUFDLFlBQVksQ0FBQztxQkFDcEUsV0FBVyxFQUFFO3FCQUNiLElBQUksQ0FDSCxTQUFTLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEtBQUssS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQzVFLENBQUE7YUFDRjtZQUVELEtBQUssVUFBVSxDQUFDLFlBQVksQ0FBQyxDQUFDO2dCQUM1QixPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLDZCQUE2QixFQUFFLE1BQU0sQ0FBQyxZQUFZLENBQUM7cUJBQzFFLFdBQVcsRUFBRTtxQkFDYixJQUFJLENBQ0gsU0FBUyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxLQUFLLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUM1RSxDQUFBO2FBQ0Y7WUFFRCxLQUFLLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDO2dCQUNqQyxPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLGtDQUFrQyxFQUFFLE1BQU0sQ0FBQyxZQUFZLENBQUM7cUJBQy9FLFdBQVcsRUFBRTtxQkFDYixJQUFJLENBQ0gsU0FBUyxDQUFDLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxLQUFLLEtBQUssU0FBUyxDQUFDLENBQUMsQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUM1RSxDQUFBO2FBQ0Y7WUFFRCxLQUFLLFVBQVUsQ0FBQyxJQUFJLENBQUM7WUFDckIsS0FBSyxVQUFVLENBQUMsUUFBUSxDQUFDLENBQUM7Z0JBRXhCLE9BQU8sSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMscUJBQXFCLEVBQUUsTUFBTSxDQUFDLFlBQVksQ0FBQztxQkFDbEUsV0FBVyxFQUFFO3FCQUNiLElBQUksQ0FDSCxTQUFTLENBQUMsQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLEtBQUssS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQzVFLENBQUE7YUFDRjtZQUVELE9BQU8sQ0FBQyxDQUFDLE9BQU8sVUFBVSxDQUFDLE9BQU8sQ0FBQyxDQUFBO1NBQ3BDO0lBQ0gsQ0FBQzs7c0dBbElVLFFBQVE7MEdBQVIsUUFBUSxjQUZQLE1BQU07NEZBRVAsUUFBUTtrQkFIcEIsVUFBVTttQkFBQztvQkFDVixVQUFVLEVBQUUsTUFBTTtpQkFDbkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBGc1Byb21wdERhdGVDb21wb25lbnQgfSBmcm9tICcuLy4uL2NvbXBvbmVudHMvcHJvbXB0LWRhdGUvcHJvbXB0LWRhdGUuY29tcG9uZW50JztcbmltcG9ydCB7XG4gIEluamVjdGFibGUsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG4vLyBNb2RhbFxuaW1wb3J0IHsgTWF0RGlhbG9nIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvZGlhbG9nJztcblxuLy8gUlhcbmltcG9ydCB7IHRocm93RXJyb3IsIG9mIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBzd2l0Y2hNYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cblxuaW1wb3J0IHsgSUZzUHJvbXB0QXV0b2NvbXBsZXRlQ2hpcHNDb25maWcsIElGc1Byb21wdENvbmZpZyB9IGZyb20gJy4uL2ludGVyZmFjZXMnO1xuXG4vLyBDb25maWdzXG5pbXBvcnQgeyBGc1Byb21wdENvbmZpZywgRnNQcm9tcHRDb25maXJtQ29uZmlnIH0gZnJvbSAnLi4vY2xhc3Nlcyc7XG5cbi8vIENvbXBvbmVudHMgZm9yIG9wZW4gaW4gbW9kYWxcbmltcG9ydCB7IEZzUHJvbXB0Q29uZmlybUNvbXBvbmVudCB9IGZyb20gJy4uL2NvbXBvbmVudHMvcHJvbXB0LWNvbmZpcm0vcHJvbXB0LWNvbmZpcm0uY29tcG9uZW50JztcbmltcG9ydCB7IEZzUHJvbXB0QXV0b2NvbXBsZXRlQ29tcG9uZW50IH0gZnJvbSAnLi4vY29tcG9uZW50cy9wcm9tcHQtYXV0b2NvbXBsZXRlL3Byb21wdC1hdXRvY29tcGxldGUuY29tcG9uZW50JztcbmltcG9ydCB7IEZzUHJvbXB0U2VsZWN0Q29tcG9uZW50IH0gZnJvbSAnLi4vY29tcG9uZW50cy9wcm9tcHQtc2VsZWN0L3Byb21wdC1zZWxlY3QuY29tcG9uZW50JztcbmltcG9ydCB7IEZzUHJvbXB0SW5wdXRDb21wb25lbnQgfSBmcm9tICcuLi9jb21wb25lbnRzL3Byb21wdC1pbnB1dC9wcm9tcHQtaW5wdXQuY29tcG9uZW50JztcbmltcG9ydCB7IFByb21wdFR5cGUgfSBmcm9tICcuLi9oZWxwZXJzL2VudW1zJztcbmltcG9ydCB7IEZzUHJvbXB0QXV0b2NvbXBsZXRlQ2hpcHNDb21wb25lbnQgfSBmcm9tICcuLi9jb21wb25lbnRzL3Byb21wdC1hdXRvY29tcGxldGUtY2hpcHMvcHJvbXB0LWF1dG9jb21wbGV0ZS1jaGlwcy5jb21wb25lbnQnO1xuXG5cblxuQEluamVjdGFibGUoe1xuICBwcm92aWRlZEluOiAncm9vdCcsXG59KVxuZXhwb3J0IGNsYXNzIEZzUHJvbXB0IHtcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGRpYWxvZzogTWF0RGlhbG9nKSB7fVxuXG4gIC8qKlxuICAgKiBPcGVuIGNvbmZpcm1hdGlvbiB3aW5kb3cgYW5kIHJldHVybiBjbG9zZSBvYnNlcnZhYmxlXG4gICAqL1xuICBwdWJsaWMgY29uZmlybShjb25maWc6IElGc1Byb21wdENvbmZpZyA9IHt9KSB7XG4gICAgY29uc3Qgb3BlbkNvbmZpZyA9IG5ldyBGc1Byb21wdENvbmZpcm1Db25maWcoY29uZmlnLCBQcm9tcHRUeXBlLmNvbmZpcm0pO1xuXG4gICAgcmV0dXJuIHRoaXMub3BlbihvcGVuQ29uZmlnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPcGVuIHdpbmRvdyB3aXRoIGlucHV0IGZpZWxkIGZvciBmaWxsaW5nXG4gICAqL1xuICBwdWJsaWMgaW5wdXQoY29uZmlnOiBJRnNQcm9tcHRDb25maWcgPSB7fSkge1xuICAgIGNvbnN0IG9wZW5Db25maWcgPSBuZXcgRnNQcm9tcHRDb25maWcoY29uZmlnLCBQcm9tcHRUeXBlLmlucHV0KTtcblxuICAgIHJldHVybiB0aGlzLm9wZW4ob3BlbkNvbmZpZyk7XG4gIH1cblxuICAvKipcbiAgICogT3BlbiBtb2RhbCB3aXRoIGxpc3RcbiAgICovXG4gIHB1YmxpYyBzZWxlY3QoY29uZmlnOiBJRnNQcm9tcHRDb25maWcgPSB7fSkge1xuICAgIGNvbnN0IG9wZW5Db25maWcgPSBuZXcgRnNQcm9tcHRDb25maWcoY29uZmlnLCBQcm9tcHRUeXBlLnNlbGVjdCk7XG5cbiAgICByZXR1cm4gdGhpcy5vcGVuKG9wZW5Db25maWcpO1xuICB9XG5cbiAgLyoqXG4gICAqIE9wZW4gbW9kYWwgd2l0aCBhdXRvY29tcGxldGVcbiAgICovXG4gIHB1YmxpYyBhdXRvY29tcGxldGUoY29uZmlnOiBJRnNQcm9tcHRDb25maWcgPSB7fSkge1xuICAgIGNvbnN0IG9wZW5Db25maWcgPSBuZXcgRnNQcm9tcHRDb25maWcoY29uZmlnLCBQcm9tcHRUeXBlLmF1dG9jb21wbGV0ZSk7XG5cbiAgICByZXR1cm4gdGhpcy5vcGVuKG9wZW5Db25maWcpO1xuICB9XG5cbiAgLyoqXG4gICAqIE9wZW4gbW9kYWwgd2l0aCBhdXRvY29tcGxldGUgY2hpcHNcbiAgICovXG4gIHB1YmxpYyBhdXRvY29tcGxldGVDaGlwcyhjb25maWc6IElGc1Byb21wdEF1dG9jb21wbGV0ZUNoaXBzQ29uZmlnID0ge30pIHtcbiAgICBjb25zdCBvcGVuQ29uZmlnID0gbmV3IEZzUHJvbXB0Q29uZmlnKGNvbmZpZywgUHJvbXB0VHlwZS5hdXRvY29tcGxldGVDaGlwcyk7XG5cbiAgICByZXR1cm4gdGhpcy5vcGVuKG9wZW5Db25maWcpO1xuICB9XG5cbiAgLyoqXG4gICAqIE9wZW4gbW9kYWwgd2l0aCBsaXN0XG4gICAqL1xuICBwdWJsaWMgZGF0ZVRpbWUoY29uZmlnOiBJRnNQcm9tcHRDb25maWcgPSB7fSkge1xuICAgIGNvbmZpZy5hdXRvZm9jdXMgPSBmYWxzZTtcbiAgICBjb25zdCBvcGVuQ29uZmlnID0gbmV3IEZzUHJvbXB0Q29uZmlnKGNvbmZpZywgUHJvbXB0VHlwZS5kYXRlVGltZSk7XG5cbiAgICByZXR1cm4gdGhpcy5vcGVuKG9wZW5Db25maWcpO1xuICB9XG5cbiAgLyoqXG4gICAqIE9wZW4gbW9kYWwgd2l0aCBsaXN0XG4gICAqL1xuICBwdWJsaWMgZGF0ZShjb25maWc6IElGc1Byb21wdENvbmZpZyA9IHt9KSB7XG4gICAgY29uZmlnLmF1dG9mb2N1cyA9IGZhbHNlO1xuICAgIGNvbnN0IG9wZW5Db25maWcgPSBuZXcgRnNQcm9tcHRDb25maWcoY29uZmlnLCBQcm9tcHRUeXBlLmRhdGUpO1xuXG4gICAgcmV0dXJuIHRoaXMub3BlbihvcGVuQ29uZmlnKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBPcGVuIG1vZGFsIGRpYWxvZyBkZXBlbmRzIGZyb20gdHlwZVxuICAgKi9cbiAgcHJpdmF0ZSBvcGVuKGNvbmZpZzogRnNQcm9tcHRDb25maWc8YW55PiB8IEZzUHJvbXB0Q29uZmlybUNvbmZpZzxhbnk+KSB7XG4gICAgLy8gRGVmYXVsdCBjbGFzc2VzIGZvciBtb2RhbFxuICAgIGNvbmZpZy5hZGREZWZhdWx0UGFuZWxDbGFzc2VzKGNvbmZpZy50eXBlKTtcblxuICAgIHN3aXRjaCAoY29uZmlnLnR5cGUpIHtcbiAgICAgIGNhc2UgUHJvbXB0VHlwZS5jb25maXJtOiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpYWxvZ1xuICAgICAgICAgIC5vcGVuKEZzUHJvbXB0Q29uZmlybUNvbXBvbmVudCwgY29uZmlnLmRpYWxvZ0NvbmZpZylcbiAgICAgICAgICAuYWZ0ZXJDbG9zZWQoKVxuICAgICAgICAgIC5waXBlKFxuICAgICAgICAgICAgc3dpdGNoTWFwKCh2YWx1ZSkgPT4gdmFsdWUgPT09IHVuZGVmaW5lZCA/IHRocm93RXJyb3IoJ2Vycm9yJykgOiBvZih2YWx1ZSkpXG4gICAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY2FzZSBQcm9tcHRUeXBlLmlucHV0OiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpYWxvZy5vcGVuKEZzUHJvbXB0SW5wdXRDb21wb25lbnQsIGNvbmZpZy5kaWFsb2dDb25maWcpXG4gICAgICAgIC5hZnRlckNsb3NlZCgpXG4gICAgICAgIC5waXBlKFxuICAgICAgICAgIHN3aXRjaE1hcCgodmFsdWUpID0+IHZhbHVlID09PSB1bmRlZmluZWQgPyB0aHJvd0Vycm9yKCdlcnJvcicpIDogb2YodmFsdWUpKVxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjYXNlIFByb21wdFR5cGUuc2VsZWN0OiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpYWxvZy5vcGVuKEZzUHJvbXB0U2VsZWN0Q29tcG9uZW50LCBjb25maWcuZGlhbG9nQ29uZmlnKVxuICAgICAgICAuYWZ0ZXJDbG9zZWQoKVxuICAgICAgICAucGlwZShcbiAgICAgICAgICBzd2l0Y2hNYXAoKHZhbHVlKSA9PiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gdGhyb3dFcnJvcignZXJyb3InKSA6IG9mKHZhbHVlKSlcbiAgICAgICAgKVxuICAgICAgfVxuXG4gICAgICBjYXNlIFByb21wdFR5cGUuYXV0b2NvbXBsZXRlOiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpYWxvZy5vcGVuKEZzUHJvbXB0QXV0b2NvbXBsZXRlQ29tcG9uZW50LCBjb25maWcuZGlhbG9nQ29uZmlnKVxuICAgICAgICAuYWZ0ZXJDbG9zZWQoKVxuICAgICAgICAucGlwZShcbiAgICAgICAgICBzd2l0Y2hNYXAoKHZhbHVlKSA9PiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8gdGhyb3dFcnJvcignZXJyb3InKSA6IG9mKHZhbHVlKSlcbiAgICAgICAgKVxuICAgICAgfVxuXG4gICAgICBjYXNlIFByb21wdFR5cGUuYXV0b2NvbXBsZXRlQ2hpcHM6IHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZGlhbG9nLm9wZW4oRnNQcm9tcHRBdXRvY29tcGxldGVDaGlwc0NvbXBvbmVudCwgY29uZmlnLmRpYWxvZ0NvbmZpZylcbiAgICAgICAgLmFmdGVyQ2xvc2VkKClcbiAgICAgICAgLnBpcGUoXG4gICAgICAgICAgc3dpdGNoTWFwKCh2YWx1ZSkgPT4gdmFsdWUgPT09IHVuZGVmaW5lZCA/IHRocm93RXJyb3IoJ2Vycm9yJykgOiBvZih2YWx1ZSkpXG4gICAgICAgIClcbiAgICAgIH1cblxuICAgICAgY2FzZSBQcm9tcHRUeXBlLmRhdGU6XG4gICAgICBjYXNlIFByb21wdFR5cGUuZGF0ZVRpbWU6IHtcblxuICAgICAgICByZXR1cm4gdGhpcy5kaWFsb2cub3BlbihGc1Byb21wdERhdGVDb21wb25lbnQsIGNvbmZpZy5kaWFsb2dDb25maWcpXG4gICAgICAgIC5hZnRlckNsb3NlZCgpXG4gICAgICAgIC5waXBlKFxuICAgICAgICAgIHN3aXRjaE1hcCgodmFsdWUpID0+IHZhbHVlID09PSB1bmRlZmluZWQgPyB0aHJvd0Vycm9yKCdlcnJvcicpIDogb2YodmFsdWUpKVxuICAgICAgICApXG4gICAgICB9XG5cbiAgICAgIGRlZmF1bHQ6IHJldHVybiB0aHJvd0Vycm9yKCdFcm9ycicpXG4gICAgfVxuICB9XG5cbn1cbiJdfQ==