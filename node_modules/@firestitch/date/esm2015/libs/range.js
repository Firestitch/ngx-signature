import { format as fnsFormat, differenceInMilliseconds } from 'date-fns';
import { getFormatString } from './get-format-string';
import { parse } from './parse';
export function range(from, to, format = 'date') {
    from = parse(from);
    to = parse(to);
    if (!to && !from) {
        return '';
    }
    if (from && !to) {
        to = from;
    }
    if (to && !from) {
        from = to;
    }
    const formatParts = format.split('-');
    let fromFormat = getFormatString(format);
    let toFormat = getFormatString(format);
    if (formatParts.indexOf('yearless') !== -1) {
        fromFormat = fromFormat.replace(' yyyy', '');
        toFormat = toFormat.replace(' yyyy', '');
    }
    if (differenceInMilliseconds(from, to) == 0) {
        return fnsFormat(from, fromFormat);
    }
    if (formatParts.indexOf('time') !== -1) {
        // date and time
        if (!from.getMinutes()) {
            fromFormat = fromFormat.replace(':mm', '');
        }
        if (!to.getMinutes()) {
            toFormat = toFormat.replace(':mm', '');
        }
        if (from.getFullYear() === to.getFullYear()) {
            if ((new Date()).getFullYear() === from.getFullYear()) {
                fromFormat = fromFormat.replace(', yyyy', '');
            }
            toFormat = toFormat.replace(', yyyy', '');
            if (from.getMonth() == to.getMonth()) {
                if (from.getDate() == to.getDate()) {
                    if ((from.getHours() < 12 && to.getHours() < 12) ||
                        (from.getHours() > 12 && to.getHours() > 12)) {
                        fromFormat = fromFormat.replace(' aaa', '');
                    }
                    toFormat = toFormat
                        .replace('MMMM', '')
                        .replace('MMM', '')
                        .replace('EEEE', '')
                        .replace('EEE', '')
                        .replace(' do', '')
                        .replace(' d', '')
                        .trim();
                }
                else {
                    // add comma after day
                    toFormat = toFormat
                        .replace(' do', ' do,')
                        .replace(' d', ' d,');
                }
            }
            else {
                // add comma after day
                toFormat = toFormat
                    .replace(' do', ' do,')
                    .replace(' d', ' d,');
            }
        }
        fromFormat = fromFormat.replace('MM d h', 'MM d · h');
    }
    else {
        // date only
        if (from.getFullYear() == to.getFullYear()) {
            fromFormat = fromFormat
                .replace(' yyyy', '')
                .replace(',', '')
                .trim();
            if (from.getMonth() == to.getMonth()) {
                if (formatParts.indexOf('day') == -1) {
                    toFormat = toFormat
                        .replace('MMMM', '')
                        .replace('MMM', '')
                        .trim();
                }
                if (from.getDate() == to.getDate()) {
                    if (formatParts.indexOf('time') === -1) {
                        fromFormat = getFormatString(format);
                        toFormat = '';
                    }
                }
            }
        }
    }
    let output = fnsFormat(from, fromFormat);
    if (toFormat) {
        output += ' – ' + fnsFormat(to, toFormat);
    }
    return output;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmFuZ2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvbGlicy9yYW5nZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsTUFBTSxJQUFJLFNBQVMsRUFBRSx3QkFBd0IsRUFBRSxNQUFNLFVBQVUsQ0FBQztBQUN6RSxPQUFPLEVBQUUsZUFBZSxFQUFFLE1BQU0scUJBQXFCLENBQUM7QUFDdEQsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUdoQyxNQUFNLFVBQVUsS0FBSyxDQUFDLElBQVUsRUFBRSxFQUFRLEVBQUUsTUFBTSxHQUFHLE1BQU07SUFFdkQsSUFBSSxHQUFHLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNuQixFQUFFLEdBQUcsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBRWYsSUFBSSxDQUFDLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRTtRQUNoQixPQUFPLEVBQUUsQ0FBQztLQUNYO0lBRUQsSUFBSSxJQUFJLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDZixFQUFFLEdBQUcsSUFBSSxDQUFDO0tBQ1g7SUFFRCxJQUFJLEVBQUUsSUFBSSxDQUFDLElBQUksRUFBRTtRQUNmLElBQUksR0FBRyxFQUFFLENBQUM7S0FDWDtJQUVELE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUM7SUFFdEMsSUFBSSxVQUFVLEdBQUcsZUFBZSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3pDLElBQUksUUFBUSxHQUFHLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUV2QyxJQUFJLFdBQVcsQ0FBQyxPQUFPLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUU7UUFDMUMsVUFBVSxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUMsT0FBTyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1FBQzdDLFFBQVEsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQztLQUMxQztJQUVELElBQUksd0JBQXdCLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRTtRQUMzQyxPQUFPLFNBQVMsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLENBQUM7S0FDcEM7SUFFRCxJQUFJLFdBQVcsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUU7UUFDdEMsZ0JBQWdCO1FBRWhCLElBQUksQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFLEVBQUU7WUFDdEIsVUFBVSxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQyxDQUFDO1NBQzVDO1FBRUQsSUFBSSxDQUFDLEVBQUUsQ0FBQyxVQUFVLEVBQUUsRUFBRTtZQUNwQixRQUFRLEdBQUcsUUFBUSxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDLENBQUM7U0FDeEM7UUFFRCxJQUFJLElBQUksQ0FBQyxXQUFXLEVBQUUsS0FBSyxFQUFFLENBQUMsV0FBVyxFQUFFLEVBQUU7WUFFM0MsSUFBSSxDQUFDLElBQUksSUFBSSxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUsS0FBSyxJQUFJLENBQUMsV0FBVyxFQUFFLEVBQUU7Z0JBQ3JELFVBQVUsR0FBRyxVQUFVLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQzthQUMvQztZQUVELFFBQVEsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxFQUFFLENBQUMsQ0FBQztZQUUxQyxJQUFJLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxFQUFFLENBQUMsUUFBUSxFQUFFLEVBQUU7Z0JBQ3BDLElBQUksSUFBSSxDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsQ0FBQyxPQUFPLEVBQUUsRUFBRTtvQkFFbEMsSUFDRSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLElBQUksRUFBRSxDQUFDLFFBQVEsRUFBRSxHQUFHLEVBQUUsQ0FBQzt3QkFDNUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRSxJQUFJLEVBQUUsQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLENBQUMsRUFDNUM7d0JBQ0EsVUFBVSxHQUFHLFVBQVUsQ0FBQyxPQUFPLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQyxDQUFDO3FCQUM3QztvQkFFRCxRQUFRLEdBQUcsUUFBUTt5QkFDZCxPQUFPLENBQUMsTUFBTSxFQUFFLEVBQUUsQ0FBQzt5QkFDbkIsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUM7eUJBQ2xCLE9BQU8sQ0FBQyxNQUFNLEVBQUUsRUFBRSxDQUFDO3lCQUNuQixPQUFPLENBQUMsS0FBSyxFQUFFLEVBQUUsQ0FBQzt5QkFDbEIsT0FBTyxDQUFDLEtBQUssRUFBRSxFQUFFLENBQUM7eUJBQ2xCLE9BQU8sQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDO3lCQUNqQixJQUFJLEVBQUUsQ0FBQztpQkFDYjtxQkFBTTtvQkFDTCxzQkFBc0I7b0JBQ3RCLFFBQVEsR0FBRyxRQUFRO3lCQUNkLE9BQU8sQ0FBQyxLQUFLLEVBQUUsTUFBTSxDQUFDO3lCQUN0QixPQUFPLENBQUMsSUFBSSxFQUFFLEtBQUssQ0FBQyxDQUFDO2lCQUMzQjthQUNGO2lCQUFNO2dCQUNMLHNCQUFzQjtnQkFDdEIsUUFBUSxHQUFHLFFBQVE7cUJBQ2QsT0FBTyxDQUFDLEtBQUssRUFBRSxNQUFNLENBQUM7cUJBQ3RCLE9BQU8sQ0FBQyxJQUFJLEVBQUUsS0FBSyxDQUFDLENBQUM7YUFDM0I7U0FDRjtRQUVELFVBQVUsR0FBRyxVQUFVLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxVQUFVLENBQUMsQ0FBQztLQUN2RDtTQUFNO1FBQ0wsWUFBWTtRQUNaLElBQUksSUFBSSxDQUFDLFdBQVcsRUFBRSxJQUFJLEVBQUUsQ0FBQyxXQUFXLEVBQUUsRUFBRTtZQUMxQyxVQUFVLEdBQUcsVUFBVTtpQkFDcEIsT0FBTyxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUM7aUJBQ3BCLE9BQU8sQ0FBQyxHQUFHLEVBQUUsRUFBRSxDQUFDO2lCQUNoQixJQUFJLEVBQUUsQ0FBQztZQUVWLElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsQ0FBQyxRQUFRLEVBQUUsRUFBRTtnQkFFcEMsSUFBSSxXQUFXLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFO29CQUNwQyxRQUFRLEdBQUcsUUFBUTt5QkFDaEIsT0FBTyxDQUFDLE1BQU0sRUFBRSxFQUFFLENBQUM7eUJBQ25CLE9BQU8sQ0FBQyxLQUFLLEVBQUUsRUFBRSxDQUFDO3lCQUNsQixJQUFJLEVBQUUsQ0FBQztpQkFDWDtnQkFFRCxJQUFJLElBQUksQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLENBQUMsT0FBTyxFQUFFLEVBQUU7b0JBQ2xDLElBQUksV0FBVyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsRUFBRTt3QkFDdEMsVUFBVSxHQUFHLGVBQWUsQ0FBQyxNQUFNLENBQUMsQ0FBQzt3QkFDckMsUUFBUSxHQUFHLEVBQUUsQ0FBQztxQkFDZjtpQkFDRjthQUNGO1NBQ0Y7S0FDRjtJQUVELElBQUksTUFBTSxHQUFHLFNBQVMsQ0FBQyxJQUFJLEVBQUUsVUFBVSxDQUFDLENBQUM7SUFDekMsSUFBSSxRQUFRLEVBQUU7UUFDWixNQUFNLElBQUksS0FBSyxHQUFHLFNBQVMsQ0FBQyxFQUFFLEVBQUUsUUFBUSxDQUFDLENBQUM7S0FDM0M7SUFFRCxPQUFPLE1BQU0sQ0FBQztBQUNsQixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZm9ybWF0IGFzIGZuc0Zvcm1hdCwgZGlmZmVyZW5jZUluTWlsbGlzZWNvbmRzIH0gZnJvbSAnZGF0ZS1mbnMnO1xuaW1wb3J0IHsgZ2V0Rm9ybWF0U3RyaW5nIH0gZnJvbSAnLi9nZXQtZm9ybWF0LXN0cmluZyc7XG5pbXBvcnQgeyBwYXJzZSB9IGZyb20gJy4vcGFyc2UnO1xuXG5cbmV4cG9ydCBmdW5jdGlvbiByYW5nZShmcm9tOiBEYXRlLCB0bzogRGF0ZSwgZm9ybWF0ID0gJ2RhdGUnKTogc3RyaW5nIHtcblxuICAgIGZyb20gPSBwYXJzZShmcm9tKTtcbiAgICB0byA9IHBhcnNlKHRvKTtcblxuICAgIGlmICghdG8gJiYgIWZyb20pIHtcbiAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICBpZiAoZnJvbSAmJiAhdG8pIHtcbiAgICAgIHRvID0gZnJvbTtcbiAgICB9XG5cbiAgICBpZiAodG8gJiYgIWZyb20pIHtcbiAgICAgIGZyb20gPSB0bztcbiAgICB9XG5cbiAgICBjb25zdCBmb3JtYXRQYXJ0cyA9IGZvcm1hdC5zcGxpdCgnLScpO1xuXG4gICAgbGV0IGZyb21Gb3JtYXQgPSBnZXRGb3JtYXRTdHJpbmcoZm9ybWF0KTtcbiAgICBsZXQgdG9Gb3JtYXQgPSBnZXRGb3JtYXRTdHJpbmcoZm9ybWF0KTtcblxuICAgIGlmIChmb3JtYXRQYXJ0cy5pbmRleE9mKCd5ZWFybGVzcycpICE9PSAtMSkge1xuICAgICAgZnJvbUZvcm1hdCA9IGZyb21Gb3JtYXQucmVwbGFjZSgnIHl5eXknLCAnJyk7XG4gICAgICB0b0Zvcm1hdCA9IHRvRm9ybWF0LnJlcGxhY2UoJyB5eXl5JywgJycpO1xuICAgIH1cblxuICAgIGlmIChkaWZmZXJlbmNlSW5NaWxsaXNlY29uZHMoZnJvbSwgdG8pID09IDApIHtcbiAgICAgIHJldHVybiBmbnNGb3JtYXQoZnJvbSwgZnJvbUZvcm1hdCk7XG4gICAgfVxuXG4gICAgaWYgKGZvcm1hdFBhcnRzLmluZGV4T2YoJ3RpbWUnKSAhPT0gLTEpIHtcbiAgICAgIC8vIGRhdGUgYW5kIHRpbWVcblxuICAgICAgaWYgKCFmcm9tLmdldE1pbnV0ZXMoKSkge1xuICAgICAgICBmcm9tRm9ybWF0ID0gZnJvbUZvcm1hdC5yZXBsYWNlKCc6bW0nLCAnJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICghdG8uZ2V0TWludXRlcygpKSB7XG4gICAgICAgIHRvRm9ybWF0ID0gdG9Gb3JtYXQucmVwbGFjZSgnOm1tJywgJycpO1xuICAgICAgfVxuXG4gICAgICBpZiAoZnJvbS5nZXRGdWxsWWVhcigpID09PSB0by5nZXRGdWxsWWVhcigpKSB7XG5cbiAgICAgICAgaWYgKChuZXcgRGF0ZSgpKS5nZXRGdWxsWWVhcigpID09PSBmcm9tLmdldEZ1bGxZZWFyKCkpIHtcbiAgICAgICAgICBmcm9tRm9ybWF0ID0gZnJvbUZvcm1hdC5yZXBsYWNlKCcsIHl5eXknLCAnJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0b0Zvcm1hdCA9IHRvRm9ybWF0LnJlcGxhY2UoJywgeXl5eScsICcnKTtcblxuICAgICAgICBpZiAoZnJvbS5nZXRNb250aCgpID09IHRvLmdldE1vbnRoKCkpIHtcbiAgICAgICAgICBpZiAoZnJvbS5nZXREYXRlKCkgPT0gdG8uZ2V0RGF0ZSgpKSB7XG5cbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgKGZyb20uZ2V0SG91cnMoKSA8IDEyICYmIHRvLmdldEhvdXJzKCkgPCAxMikgfHxcbiAgICAgICAgICAgICAgKGZyb20uZ2V0SG91cnMoKSA+IDEyICYmIHRvLmdldEhvdXJzKCkgPiAxMilcbiAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICBmcm9tRm9ybWF0ID0gZnJvbUZvcm1hdC5yZXBsYWNlKCcgYWFhJywgJycpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0b0Zvcm1hdCA9IHRvRm9ybWF0XG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoJ01NTU0nLCAnJylcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgnTU1NJywgJycpXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoJ0VFRUUnLCAnJylcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgnRUVFJywgJycpXG4gICAgICAgICAgICAgICAgLnJlcGxhY2UoJyBkbycsICcnKVxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKCcgZCcsICcnKVxuICAgICAgICAgICAgICAgIC50cmltKCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIGFkZCBjb21tYSBhZnRlciBkYXlcbiAgICAgICAgICAgIHRvRm9ybWF0ID0gdG9Gb3JtYXRcbiAgICAgICAgICAgICAgICAucmVwbGFjZSgnIGRvJywgJyBkbywnKVxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKCcgZCcsICcgZCwnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gYWRkIGNvbW1hIGFmdGVyIGRheVxuICAgICAgICAgIHRvRm9ybWF0ID0gdG9Gb3JtYXRcbiAgICAgICAgICAgICAgLnJlcGxhY2UoJyBkbycsICcgZG8sJylcbiAgICAgICAgICAgICAgLnJlcGxhY2UoJyBkJywgJyBkLCcpO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZyb21Gb3JtYXQgPSBmcm9tRm9ybWF0LnJlcGxhY2UoJ01NIGQgaCcsICdNTSBkIMK3IGgnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gZGF0ZSBvbmx5XG4gICAgICBpZiAoZnJvbS5nZXRGdWxsWWVhcigpID09IHRvLmdldEZ1bGxZZWFyKCkpIHtcbiAgICAgICAgZnJvbUZvcm1hdCA9IGZyb21Gb3JtYXRcbiAgICAgICAgICAucmVwbGFjZSgnIHl5eXknLCAnJylcbiAgICAgICAgICAucmVwbGFjZSgnLCcsICcnKVxuICAgICAgICAgIC50cmltKCk7XG5cbiAgICAgICAgaWYgKGZyb20uZ2V0TW9udGgoKSA9PSB0by5nZXRNb250aCgpKSB7XG5cbiAgICAgICAgICBpZiAoZm9ybWF0UGFydHMuaW5kZXhPZignZGF5JykgPT0gLTEpIHtcbiAgICAgICAgICAgIHRvRm9ybWF0ID0gdG9Gb3JtYXRcbiAgICAgICAgICAgICAgLnJlcGxhY2UoJ01NTU0nLCAnJylcbiAgICAgICAgICAgICAgLnJlcGxhY2UoJ01NTScsICcnKVxuICAgICAgICAgICAgICAudHJpbSgpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChmcm9tLmdldERhdGUoKSA9PSB0by5nZXREYXRlKCkpIHtcbiAgICAgICAgICAgIGlmIChmb3JtYXRQYXJ0cy5pbmRleE9mKCd0aW1lJykgPT09IC0xKSB7XG4gICAgICAgICAgICAgIGZyb21Gb3JtYXQgPSBnZXRGb3JtYXRTdHJpbmcoZm9ybWF0KTtcbiAgICAgICAgICAgICAgdG9Gb3JtYXQgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBsZXQgb3V0cHV0ID0gZm5zRm9ybWF0KGZyb20sIGZyb21Gb3JtYXQpO1xuICAgIGlmICh0b0Zvcm1hdCkge1xuICAgICAgb3V0cHV0ICs9ICcg4oCTICcgKyBmbnNGb3JtYXQodG8sIHRvRm9ybWF0KTtcbiAgICB9XG5cbiAgICByZXR1cm4gb3V0cHV0O1xufVxuIl19